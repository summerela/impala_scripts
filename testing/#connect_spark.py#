import os
import sys


########################
### Connect to spark ###
########################

# Path for spark source folder
os.environ['SPARK_HOME']="/opt/cloudera/parcels/CDH/lib/spark"

# Append pyspark  to Python Path
sys.path.append("/opt/cloudera/parcels/CDH/lib/spark/python")

# try to import pyspark, throw error if..error
try:
    from pyspark import SparkContext
    from pyspark import SparkConf

    print ("Successfully imported Spark Modules")
    conf = (SparkConf()
       .setMaster("local")
       .setAppName("spark test")
       .set("spark.executor.memory", "1g"))

    sc = 
    return sc

except ImportError as e:
    print (e)


sc = SparkContext(conf=conf)conf = (SparkConf()
       .setMaster("local")
       .setAppName("spark test")
       .set("spark.executor.memory", "1g"))


print sc
